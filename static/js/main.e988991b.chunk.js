(this["webpackJsonpfamiliar-pwa2"]=this["webpackJsonpfamiliar-pwa2"]||[]).push([[0],{40:function(e,t,n){},41:function(e,t,n){},89:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(5),c=n.n(a),o=n(33),i=n.n(o),s=(n(40),n(41),n(6)),u=n.n(s),l=n(10),f=n(9),h=n(22),j=n.n(h),b=n(12),p=n(34),d=function(){var e=function(){var e=Object(l.a)(u.a.mark((function e(){var n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showOpenFilePicker();case 2:n=e.sent,r=Object(f.a)(n,1),a=r[0],O.set(a,"BG fileHandle"),t(a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getFile();case 2:n=e.sent,O.set(n,"BG image");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)("div",{children:Object(r.jsx)("button",{className:"add-button",onClick:e,children:"BG iamge"})})},g=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.get("BG image");case 3:n=e.sent,r=window.URL||window.webkitURL,t=r.createObjectURL(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t="./img/bg.jpg";case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),v=Object(p.a)("keyval-store",1,{upgrade:function(e){e.createObjectStore("keyval")}}),O={get:function(e){return Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v;case 2:return t.abrupt("return",t.sent.get("keyval",e));case 3:case"end":return t.stop()}}),t)})))()},set:function(e,t){return Object(l.a)(u.a.mark((function n(){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v;case 2:return n.abrupt("return",n.sent.put("keyval",e,t));case 3:case"end":return n.stop()}}),n)})))()},delete:function(e){return Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v;case 2:return t.abrupt("return",t.sent.delete("keyval",e));case 3:case"end":return t.stop()}}),t)})))()},clear:function(){return Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v;case 2:return e.abrupt("return",e.sent.clear("keyval"));case 3:case"end":return e.stop()}}),e)})))()},keys:function(){return Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v;case 2:return e.abrupt("return",e.sent.getAllKeys("keyval"));case 3:case"end":return e.stop()}}),e)})))()}},m=function(e){var t=Object(a.useState)(),n=Object(f.a)(t,2),c=n[0],o=n[1],i=j()(c),s=Object(f.a)(i,1)[0],h=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:t=e.sent,o(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){h()}),[]),Object(r.jsx)(b.Image,{width:e.w,height:e.h,image:s,onClick:h})},w=function(){var e=j()("./img/walking_01.png"),t=Object(f.a)(e,1)[0];return Object(r.jsx)(b.Image,{width:500,height:500,x:390,y:130,image:t})},x=function(e){return Object(r.jsx)(b.Stage,{className:"stage",width:e.w,height:e.h,children:Object(r.jsxs)(b.Layer,{children:[Object(r.jsx)(m,{w:e.w,h:e.h}),Object(r.jsx)(w,{})]})})},k=n(35),y=function(e){var t=e.chat,n=Object(a.useRef)(null),c=Object(a.useState)(!1),o=Object(f.a)(c,2),i=o[0],s=o[1];return Object(a.useEffect)((function(){n.current.scrollIntoView({block:"end"})}),[t]),Object(r.jsxs)("div",{className:"chats",onClick:function(){s((function(e){return!e}))},children:[t.map((function(e){return Object(r.jsxs)("div",{className:"chat",children:[Object(r.jsx)("strong",{children:"\u3042\u306a\u305f: "}),e.mesage,Object(r.jsx)("br",{}),i?" ("+e.option+")":e.option[e.response]]},e.key)})),Object(r.jsx)("div",{ref:n})]})},S=function(e){var t=e.send,n=Object(a.useState)(""),c=Object(f.a)(n,2),o=c[0],i=c[1],s=Object(a.useState)(""),u=Object(f.a)(s,2),l=u[0],h=u[1],j=function(){t(o,l),i("")};return Object(r.jsxs)("div",{className:"chatInputContainer",onKeyUp:function(e){13===e.keyCode&&j()},children:[Object(r.jsx)("input",{type:"text",className:"chatInput",placeholder:"\u8cea\u554f",onChange:function(e){return i(e.target.value)},value:o}),Object(r.jsx)("input",{type:"text",className:"chatInput",placeholder:"\u306f\u3044/\u3044\u3048\u3048",onChange:function(e){return h(e.target.value)},value:l}),Object(r.jsx)("button",{className:"chatBtn",onClick:j,children:"\u78ba\u8a8d"})]})},I=function(){var e=Object(a.useState)((function(){var e=localStorage.getItem("chat");return null===e?[]:JSON.parse(e)})),t=Object(f.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){localStorage.setItem("chat",JSON.stringify(n))}),[n]),Object(r.jsxs)("div",{className:"chatBox text",children:[Object(r.jsx)("strong",{children:"\u30da\u30c3\u30c8\u306b\u805e\u304f:"}),Object(r.jsx)("button",{className:"chatBtn",onClick:function(){return c([])},children:"\u30ea\u30bb\u30c3\u30c8"}),Object(r.jsx)(y,{chat:n}),Object(r.jsx)(S,{send:function(e,t){if(""!==e|""!==t){var r=t.split(/[\s,]/);r=null===r?[]:r,c((function(t){return[].concat(Object(k.a)(t),[(a=e,c=r,{key:n.length,mesage:a,option:c,response:Math.floor(Math.random()*c.length)})]);var a,c}))}}})]})},N=function(){var e=36e6,t=36e6,n=6e4,c=Object(a.useState)((function(){var t=localStorage.getItem("hungryCount");if(null===t|isNaN(Number(t)))return e;var n=localStorage.getItem("hungryTimestamp"),r=t-(Date.now()-n);return r>=e?e:r<0?0:r})),o=Object(f.a)(c,2),i=o[0],s=o[1],u=function(){return Math.round(5*i/e)},l=function(t){s((function(n){var r=n+t;return r>=e?e:r<0?0:r}))};Object(a.useEffect)((function(){localStorage.setItem("hungryCount",i),localStorage.setItem("hungryTimestamp",Date.now())}),[i]);var h=Object(a.useState)((function(){var e=localStorage.getItem("healthCount");if(null===e|isNaN(Number(e)))return t;if(i>0)return e;e=Number(e);var n=localStorage.getItem("healthTimestamp"),r=localStorage.getItem("hungryCount"),a=localStorage.getItem("hungryTimestamp"),c=e+(r-(Date.now()-a))-(Date.now()-n);return c>=t?t:c<0?0:c})),j=Object(f.a)(h,2),b=j[0],p=j[1],d=function(){return Math.floor(5*b/t)},g=function(e){p((function(n){var r=n+e;return r>=t?t:r<0?0:r}))};return Object(a.useEffect)((function(){localStorage.setItem("healthCount",b),localStorage.setItem("healthTimestamp",Date.now())}),[b]),Object(a.useEffect)((function(){if(i>0){var e=setInterval((function(){l(-6e4)}),n);return function(){return clearInterval(e)}}if(b>0){var t=setInterval((function(){g(-6e4)}),n);return function(){return clearInterval(t)}}})),Object(r.jsxs)("div",{className:"text feed",children:[Object(r.jsx)("strong",{children:"\u6e80\u8179\u5ea6:"})," ","\ud83c\udf56".repeat(u())," ",0===u()&&"\uff08\u7a7a\u8179\uff01\ud83d\ude28\uff09",Object(r.jsx)("br",{}),Object(r.jsx)("strong",{children:"\u5065\u5eb7\u5ea6:"})," ","\u2764 ".repeat(d())," ",0===d()&&"\uff08\u7015\u6b7b\uff01\ud83d\udc80\uff09",Object(r.jsx)("br",{}),Object(r.jsx)("button",{type:"button",onClick:function(){l(36e5)},children:"\u98df\u4e8b"}),Object(r.jsx)("button",{type:"button",onClick:function(){g(36e5)},children:"\u6cbb\u7642"})]})};var C=function(){return Object(r.jsx)("div",{className:"container",children:Object(r.jsxs)("div",{className:"sub-container",width:1280,height:720,children:[Object(r.jsx)(x,{w:1280,h:720}),Object(r.jsx)(N,{}),Object(r.jsx)(I,{}),Object(r.jsx)(d,{})]})})},B=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function E(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,90)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(C,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/familiar-pwa2",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/familiar-pwa2","/service-worker.js");B?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):E(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):E(t,e)}))}}(),T()}},[[89,1,2]]]);
//# sourceMappingURL=main.e988991b.chunk.js.map